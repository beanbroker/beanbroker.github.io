<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>beanbroker blog</title>
  
  <subtitle>끝없는 공부</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2019-09-08T08:32:57.985Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>beanbroker</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Kotlin, Auth with JWT 2장</title>
    <link href="http://yoursite.com/2019/09/08/Kotlin/kotlin_jwt_spring2/"/>
    <id>http://yoursite.com/2019/09/08/Kotlin/kotlin_jwt_spring2/</id>
    <published>2019-09-08T08:30:00.000Z</published>
    <updated>2019-09-08T08:32:57.985Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Kotlin-Auth-with-JWT-2장"><a href="#Kotlin-Auth-with-JWT-2장" class="headerlink" title="Kotlin, Auth with JWT 2장"></a>Kotlin, Auth with JWT 2장</h1><p><a href="https://github.com/beanbroker/kotlin_querydsl" rel="external nofollow noopener noreferrer" target="_blank">git source</a> 샘플소스 링크</p><p>대충 다만들고 나니.. 순서대로 어떻게 해야할지를 까먹어 모든 소스 첨부</p><h2 id="인터셉터에-토큰-검증-해보기"><a href="#인터셉터에-토큰-검증-해보기" class="headerlink" title="인터셉터에 토큰 검증 해보기"></a>인터셉터에 토큰 검증 해보기</h2><blockquote><p>SampleAuthInterceptor.class</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SampleAuthInterceptor</span>(</span></span><br><span class="line">        val tokenService: SampleTokenService</span><br><span class="line">) : HandlerInterceptor &#123;</span><br><span class="line"></span><br><span class="line">    companion object &#123;</span><br><span class="line"></span><br><span class="line">        val HEADER_NAME = <span class="string">"X-token"</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> val HEADER_NAME = <span class="string">"X-token"</span></span><br><span class="line"></span><br><span class="line">     <span class="function">override fun <span class="title">preHandle</span><span class="params">(request: HttpServletRequest, response: HttpServletResponse, handler: Any)</span>: Boolean </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (handler !is HandlerMethod) <span class="keyword">return</span> <span class="keyword">true</span></span><br><span class="line">        val handlerMethod = handler</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!handlerMethod.hasMethodAnnotation(SampleAuthorization::<span class="class"><span class="keyword">class</span>.<span class="title">java</span>))</span></span><br><span class="line"><span class="class">            <span class="title">return</span> <span class="title">true</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">        <span class="title">val</span> <span class="title">token</span> </span>= request.getHeader(HEADER_NAME)</span><br><span class="line"></span><br><span class="line">        token?.let &#123;</span><br><span class="line">            tokenService.decodeToken(it)</span><br><span class="line">        &#125;?: <span class="keyword">throw</span> RuntimeException(<span class="string">"없으면 앙대유"</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li><p>handlerMethod.hasMethodAnnotation(SampleAuthorization::class.java)<br> 해당 메소드에 SampleAuthorization어노테이션이 붙어있는지 없는지?</p></li><li><p>있을경우에는 토큰 검증</p></li><li><p>token없으면 안됨 팅겨버림</p></li></ol><h2 id="어노테이션을-만들어보자"><a href="#어노테이션을-만들어보자" class="headerlink" title="어노테이션을 만들어보자"></a>어노테이션을 만들어보자</h2><p>어노테이션을 만들기전에 아래의 링크 필수 참고</p><p><a href="https://kotlinlang.org/docs/reference/annotations.html" rel="external nofollow noopener noreferrer" target="_blank">kotlin annotation</a> 링크</p><p>ava annotations are 100% compatible with Kotlin ( 기존 자바 하시던 분들은 이해하는데 문제가 전혀 없음 )</p><blockquote><p>SampleAuthorization<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Target</span>(AnnotationTarget.FUNCTION)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="function">annotation class <span class="title">SampleAuthorization</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        val data: Int = <span class="number">0</span></span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span></span><br></pre></td></tr></table></figure></p></blockquote><h2 id="위의-interceptor를-등록하자"><a href="#위의-interceptor를-등록하자" class="headerlink" title="위의 interceptor를 등록하자"></a>위의 interceptor를 등록하자</h2><blockquote><p>SampleAuthConfig.class</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SampleAuthConfig</span>(</span></span><br><span class="line">        val tokenService: SampleTokenService</span><br><span class="line">) : WebMvcConfigurer &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function">override fun <span class="title">addInterceptors</span><span class="params">(registry: InterceptorRegistry)</span> </span>&#123;</span><br><span class="line">        registry.addInterceptor(SampleAuthInterceptor(tokenService))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>InterceptorRegistry에  직접 구현한 SampleAuthInterceptor를 등록 또는 추가</li><li>정상작동</li></ol><h2 id="테스트를-해보자"><a href="#테스트를-해보자" class="headerlink" title="테스트를 해보자"></a>테스트를 해보자</h2><ul><li>예를 들어 토큰이 있어야만 볼수 있는 유저의 정보가 있다고 가정하였을 때 아래와같이 정보를 제공한다</li><li>SampleAuthorization를 붙임으로서 위의 토큰 검증</li></ul><blockquote><p>AuthController</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/auth"</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AuthController</span></span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@SampleAuthorization</span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/test"</span>)</span><br><span class="line">    <span class="function">fun <span class="title">testGetInfo</span><span class="params">()</span>: String </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"success"</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>테스트 진행</p><ol><li><p>header 에 토큰이 없을 경우</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"timestamp"</span>: <span class="string">"2019-09-08T08:24:31.358+0000"</span>,</span><br><span class="line">    <span class="attr">"status"</span>: <span class="number">500</span>,</span><br><span class="line">    <span class="attr">"error"</span>: <span class="string">"Internal Server Error"</span>,</span><br><span class="line">    <span class="attr">"message"</span>: <span class="string">"없으면 앙대유"</span>,</span><br><span class="line">    <span class="attr">"path"</span>: <span class="string">"/auth/test"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>이상한 토큰이 있을 경우</p></li></ol><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">"timestamp"</span>: <span class="string">"2019-09-08T08:30:51.329+0000"</span>,</span><br><span class="line">    <span class="attr">"status"</span>: <span class="number">500</span>,</span><br><span class="line">    <span class="attr">"error"</span>: <span class="string">"Internal Server Error"</span>,</span><br><span class="line">    <span class="attr">"message"</span>: <span class="string">"The token was expected to have 3 parts, but got 1."</span>,</span><br><span class="line">    <span class="attr">"path"</span>: <span class="string">"/auth/test"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>정상일 경우<br>success리턴</li></ol><h2 id="마치며"><a href="#마치며" class="headerlink" title="마치며"></a>마치며</h2><ol><li>jwt와 auth를 꼭 스프링 시큐리티 없이도 간단하게 구현 할수 있다.</li><li>스프링 시큐리티는 해도해도 어렵다. 그래서 위처럼 샘플 코드를 만들어보았다.</li><li>에러가 발생시 위처럼 뜨는데 이상하지 않나요? -&gt; 직접 runtimeExeption을 상속받아 자신만의 Exception객체 생성하여 던지고 RestControllerAdvice에서 처리</li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Kotlin-Auth-with-JWT-2장&quot;&gt;&lt;a href=&quot;#Kotlin-Auth-with-JWT-2장&quot; class=&quot;headerlink&quot; title=&quot;Kotlin, Auth with JWT 2장&quot;&gt;&lt;/a&gt;Kotlin, Auth wit
      
    
    </summary>
    
      <category term="Spring" scheme="http://yoursite.com/categories/Spring/"/>
    
      <category term="Kotlin" scheme="http://yoursite.com/categories/Spring/Kotlin/"/>
    
      <category term="JWT" scheme="http://yoursite.com/categories/Spring/Kotlin/JWT/"/>
    
    
      <category term="Spring" scheme="http://yoursite.com/tags/Spring/"/>
    
      <category term="Kotlin" scheme="http://yoursite.com/tags/Kotlin/"/>
    
      <category term="JWT" scheme="http://yoursite.com/tags/JWT/"/>
    
  </entry>
  
  <entry>
    <title>Kotlin, Auth with JWT 1장</title>
    <link href="http://yoursite.com/2019/09/08/Kotlin/kotlin_jwt_spring1/"/>
    <id>http://yoursite.com/2019/09/08/Kotlin/kotlin_jwt_spring1/</id>
    <published>2019-09-08T07:50:00.000Z</published>
    <updated>2019-09-08T08:22:08.094Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Kotlin-Auth-with-JWT-1장"><a href="#Kotlin-Auth-with-JWT-1장" class="headerlink" title="Kotlin, Auth with JWT 1장"></a>Kotlin, Auth with JWT 1장</h1><p><a href="https://github.com/beanbroker/kotlin_querydsl" rel="external nofollow noopener noreferrer" target="_blank">git source</a> 샘플소스 링크</p><h2 id="사전작업"><a href="#사전작업" class="headerlink" title="사전작업"></a>사전작업</h2><blockquote><p>build.gradle</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">implementation(<span class="string">"com.auth0:java-jwt:3.8.1"</span>)</span><br></pre></td></tr></table></figure><p>jwt관련 부분 추가!</p><h2 id="우선-토큰을-생성해보자"><a href="#우선-토큰을-생성해보자" class="headerlink" title="우선 토큰을 생성해보자"></a>우선 토큰을 생성해보자</h2><blockquote><p>SampleTokenService.class</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SampleTokenService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    companion object &#123;</span><br><span class="line"></span><br><span class="line">        val ISSURE = <span class="string">"BEANBROKER"</span></span><br><span class="line">        val SCRET = <span class="string">"1234"</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">fun <span class="title">publish</span><span class="params">(id: Long, authType: String)</span>: String? </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//60 * 60 * 24</span></span><br><span class="line">        val now = LocalDateTime.now()</span><br><span class="line">        val expiredAt = now.plusSeconds(<span class="number">86400</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> JWT.create()</span><br><span class="line">                .withClaim(<span class="string">"id"</span>, id)</span><br><span class="line">                .withClaim(<span class="string">"authType"</span>, authType)</span><br><span class="line">                .withIssuedAt(Date.from(now.atZone(ZoneId.systemDefault()).toInstant()))</span><br><span class="line">                .withIssuer(ISSURE)</span><br><span class="line">                .withExpiresAt(Date.from(expiredAt.atZone(ZoneId.systemDefault()).toInstant()))</span><br><span class="line">                .sign(Algorithm.HMAC256(SCRET))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>해당 토큰의 만료기간은 하루</li><li>ISSURE: 토큰 발급자</li></ol><blockquote><p>SampleAuthTests.class</p></blockquote><p>테스트코드 짜기 귀찮으니 콘솔로 확인하자</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@RunWith</span>(SpringRunner::<span class="class"><span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">SpringBootTest</span></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">SampleAuthTests</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> lateinit <span class="keyword">var</span> tokenService: SampleTokenService</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function">fun <span class="title">createToken</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        val token = tokenService.publish(<span class="number">1000</span>, <span class="string">"USER"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        println(token)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>결과 : eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJCRUFOQlJPS0VSIiwiaWQiOjEwMDAsImF1dGhUeXBlIjoiVVNFUiIsImV4cCI6MTU2ODAxNTE1MywiaWF0IjoxNTY3OTI4NzUzfQ.-9_1Cq7Tc19lo3lcNc0G4Y_CjVZDWmoHzWAE7iWNWYM</p><h2 id="토큰을-생성했으니-토큰을-decode해보자"><a href="#토큰을-생성했으니-토큰을-decode해보자" class="headerlink" title="토큰을 생성했으니 토큰을 decode해보자"></a>토큰을 생성했으니 토큰을 decode해보자</h2><blockquote><p>SampleTokenService.class 에 추가</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">fun <span class="title">decodeToken</span><span class="params">(token : String)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">       val jwt = JWT.require(Algorithm.HMAC256(SCRET))</span><br><span class="line">               .withIssuer(ISSURE)</span><br><span class="line">               .build()</span><br><span class="line">               .verify(token)</span><br><span class="line"></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>위와같이 jwt 생성 및 디코드를 진행해보았다.</p><p>자… 그럼 이걸 서비스 로직에서 쓰일 정도로 올리는 작업을 해보자</p><h2 id="리팩토링을-해보자"><a href="#리팩토링을-해보자" class="headerlink" title="리팩토링을 해보자"></a>리팩토링을 해보자</h2><ul><li>우선 client에게 제공할수 있도록 데이터를 만들어보자</li></ul><blockquote><p>BeanbrokerToken.class</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BeanbrokerToken</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> token: String = <span class="string">""</span></span><br><span class="line">    <span class="keyword">var</span> expireDate: LocalDateTime? = <span class="keyword">null</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>token : 방금 위에서 생성한 토큰<br>expireDate : 만료시간(클라이언트에게 만료시간 전달)</p><blockquote><p>SampleTokenService.class createToken변경</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">fun <span class="title">createToken</span><span class="params">(id: Long, authType: String)</span>: BeanbrokerToken </span>&#123;</span><br><span class="line"></span><br><span class="line">       <span class="comment">//60 * 60 * 24</span></span><br><span class="line">       val now = LocalDateTime.now()</span><br><span class="line">       val expiredAt = now.plusSeconds(<span class="number">86400</span>)</span><br><span class="line"></span><br><span class="line">       <span class="keyword">return</span> BeanbrokerToken().apply &#123;</span><br><span class="line">           <span class="keyword">this</span>.expireDate = expiredAt</span><br><span class="line">           <span class="keyword">this</span>.token = JWT.create()</span><br><span class="line">                   .withClaim(<span class="string">"id"</span>, id)</span><br><span class="line">                   .withClaim(<span class="string">"authType"</span>, authType)</span><br><span class="line">                   .withIssuedAt(Date.from(now.atZone(ZoneId.systemDefault()).toInstant()))</span><br><span class="line">                   .withIssuer(ISSURE)</span><br><span class="line">                   .withExpiresAt(Date.from(expiredAt.atZone(ZoneId.systemDefault()).toInstant()))</span><br><span class="line">                   .sign(Algorithm.HMAC256(SCRET))</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h2 id="만약에-위와같이-하고-사용하게-한다면"><a href="#만약에-위와같이-하고-사용하게-한다면" class="headerlink" title="만약에 위와같이 하고 사용하게 한다면?"></a>만약에 위와같이 하고 사용하게 한다면?</h2><p>header에 토큰 정보를 심어 보낸다고 가정하였을때 컨트롤러 단에서 헤더 매번까서 확인하는게 좋을가요…? 아니면 interceptor(AOP)에서 검증하는게 좋을가요?</p><p>라는 고민을 하였을 때 당연히 후자! 해당 부분을 추가해보자 2장에서</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Kotlin-Auth-with-JWT-1장&quot;&gt;&lt;a href=&quot;#Kotlin-Auth-with-JWT-1장&quot; class=&quot;headerlink&quot; title=&quot;Kotlin, Auth with JWT 1장&quot;&gt;&lt;/a&gt;Kotlin, Auth wit
      
    
    </summary>
    
      <category term="Spring" scheme="http://yoursite.com/categories/Spring/"/>
    
      <category term="Kotlin" scheme="http://yoursite.com/categories/Spring/Kotlin/"/>
    
      <category term="JWT" scheme="http://yoursite.com/categories/Spring/Kotlin/JWT/"/>
    
    
      <category term="Spring" scheme="http://yoursite.com/tags/Spring/"/>
    
      <category term="Kotlin" scheme="http://yoursite.com/tags/Kotlin/"/>
    
      <category term="JWT" scheme="http://yoursite.com/tags/JWT/"/>
    
  </entry>
  
  <entry>
    <title>redis 무료 cloud 사용해보기</title>
    <link href="http://yoursite.com/2019/08/31/etc/redis_cloud/"/>
    <id>http://yoursite.com/2019/08/31/etc/redis_cloud/</id>
    <published>2019-08-31T07:50:00.000Z</published>
    <updated>2019-08-31T08:01:16.788Z</updated>
    
    <content type="html"><![CDATA[<h1 id="무료-redis-cloud-사용해보기"><a href="#무료-redis-cloud-사용해보기" class="headerlink" title="무료 redis cloud 사용해보기"></a>무료 redis cloud 사용해보기</h1><p><a href="https://zetawiki.com/wiki/Redis_Cloud_%EB%AC%B4%EB%A3%8C_%EC%82%AC%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0" rel="external nofollow noopener noreferrer" target="_blank">제타 위키 Redis Cloud 무료 사용해보기 </a></p><h2 id="설치-후-접속할때-redis-cli만-설치하여-사용해보자"><a href="#설치-후-접속할때-redis-cli만-설치하여-사용해보자" class="headerlink" title="설치 후 접속할때 redis-cli만 설치하여 사용해보자"></a>설치 후 접속할때 redis-cli만 설치하여 사용해보자</h2><p>home brew설정 알아서… 블로그에 많이나옴</p><p>레디스cli만 설치하자!</p><blockquote><p>cli는 아래와 같음</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">brew tap ringohub/redis-cli</span><br><span class="line">brew update &amp;&amp; brew doctor</span><br><span class="line">brew install redis-cli</span><br></pre></td></tr></table></figure><p>설치가 정상적으로 끝난 후</p><blockquote><p>예시</p></blockquote><p>redis-cli -h redis-호스트호스트호스트loud.redislabs.com -p ‘port(포트)’ -a ‘password(비밀번호)’</p><p>redis-cli -h samplehost.com -p 12345 -a ‘password123’</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;무료-redis-cloud-사용해보기&quot;&gt;&lt;a href=&quot;#무료-redis-cloud-사용해보기&quot; class=&quot;headerlink&quot; title=&quot;무료 redis cloud 사용해보기&quot;&gt;&lt;/a&gt;무료 redis cloud 사용해보기&lt;/h1&gt;&lt;
      
    
    </summary>
    
      <category term="redis" scheme="http://yoursite.com/categories/redis/"/>
    
      <category term="redis-cli" scheme="http://yoursite.com/categories/redis/redis-cli/"/>
    
    
      <category term="redis" scheme="http://yoursite.com/tags/redis/"/>
    
      <category term="redis-cli" scheme="http://yoursite.com/tags/redis-cli/"/>
    
  </entry>
  
  <entry>
    <title>Kotlin, Querydsl 5장(audit 추가분)</title>
    <link href="http://yoursite.com/2019/08/25/Kotlin/kotlin_queryDsl5/"/>
    <id>http://yoursite.com/2019/08/25/Kotlin/kotlin_queryDsl5/</id>
    <published>2019-08-25T07:50:00.000Z</published>
    <updated>2019-08-25T07:46:25.197Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Kotlin-Querydsl-5장-JPA-Auditing-추가-분"><a href="#Kotlin-Querydsl-5장-JPA-Auditing-추가-분" class="headerlink" title="Kotlin, Querydsl 5장 (JPA Auditing) 추가 분"></a>Kotlin, Querydsl 5장 (JPA Auditing) 추가 분</h1><p><a href="https://beanbroker.github.io/2019/02/13/Kotlin/kotlin_queryDsl2/" rel="external nofollow noopener noreferrer" target="_blank">코틀린 2장 audit </a> 기존 audit 관련 링크</p><p><a href="https://github.com/beanbroker/kotlin_querydsl" rel="external nofollow noopener noreferrer" target="_blank">git source</a> 샘플소스 링크</p><h2 id="기존-코드의-문제점"><a href="#기존-코드의-문제점" class="headerlink" title="기존 코드의 문제점"></a>기존 코드의 문제점</h2><p>아래오 같이 모든 enitiy에 createdAt, updatedAy, etc..등이 모두 붙어있다.. 해당 부분만을 빼보자 코드를 중복할수 없지 아니한가!</p><blockquote><p>기존 코드</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span>(name = <span class="string">"users"</span>)</span><br><span class="line"><span class="meta">@EntityListeners</span>(AuditingEntityListener::<span class="class"><span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">UserEntity</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"seq"</span>)</span><br><span class="line">    <span class="keyword">var</span> seq = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"name"</span>)</span><br><span class="line">    <span class="keyword">var</span> name = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"age"</span>)</span><br><span class="line">    <span class="keyword">var</span> age = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"gender"</span>)</span><br><span class="line">    <span class="keyword">var</span> gender = <span class="string">""</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@CreatedDate</span></span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"created_at"</span> , nullable = <span class="keyword">false</span>, updatable = <span class="keyword">false</span>,  columnDefinition = <span class="string">"DATE"</span>)</span><br><span class="line">    <span class="keyword">var</span> createdAt  : LocalDateTime = LocalDateTime.now()</span><br><span class="line"></span><br><span class="line">    <span class="meta">@CreatedBy</span></span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"created_by"</span>)</span><br><span class="line">    <span class="keyword">var</span> createdBy = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@LastModifiedDate</span></span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"updated_at"</span>, columnDefinition = <span class="string">"DATE"</span>)</span><br><span class="line">    <span class="keyword">var</span> updatedAt  : LocalDateTime = LocalDateTime.now()</span><br><span class="line"></span><br><span class="line">    <span class="meta">@LastModifiedBy</span></span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"updated_by"</span>)</span><br><span class="line">    <span class="keyword">var</span> updateBy = <span class="string">""</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>변경 코드</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span>(name = <span class="string">"users"</span>)</span><br><span class="line">class UserEntity : BaseEntity() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"seq"</span>)</span><br><span class="line">    <span class="keyword">var</span> seq = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"name"</span>)</span><br><span class="line">    <span class="keyword">var</span> name = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"age"</span>)</span><br><span class="line">    <span class="keyword">var</span> age = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"gender"</span>)</span><br><span class="line">    <span class="keyword">var</span> gender = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"user_Id"</span>)</span><br><span class="line">    <span class="keyword">var</span> userId = <span class="string">""</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"email"</span>)</span><br><span class="line">    <span class="keyword">var</span> email = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@EntityListeners(value = [AuditingEntityListener::class])</span><br><span class="line"><span class="meta">@MappedSuperclass</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseEntity</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@CreatedBy</span></span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"created_by"</span>, length = <span class="number">15</span>)</span><br><span class="line">    <span class="keyword">var</span> createBy: String? = <span class="keyword">null</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@CreatedDate</span></span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"created_at"</span> , nullable = <span class="keyword">false</span>, updatable = <span class="keyword">false</span>,  columnDefinition = <span class="string">"DATE"</span>)</span><br><span class="line">    <span class="keyword">var</span> createdAt: LocalDateTime? = <span class="keyword">null</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@LastModifiedDate</span></span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"updated_at"</span>, columnDefinition = <span class="string">"DATE"</span>)</span><br><span class="line">    <span class="keyword">var</span> updatedAt  : LocalDateTime = LocalDateTime.now()</span><br><span class="line"></span><br><span class="line">    <span class="meta">@LastModifiedBy</span></span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"updated_by"</span>, length = <span class="number">15</span>)</span><br><span class="line">    <span class="keyword">var</span> updateBy: String? = <span class="keyword">null</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>누구든.. 쉽게 이해가 가능!</p><p>@MappedSuperclass -&gt;  맵핑되는 정보만 제공하고 싶을때 더 자세한 내용은 영어로 된글을 읽으면 이해가 됩니다. </p><p>스프링 시큐리티 없이 권한 부여 및 회원가입 진행해보기 프로젝트를 해당 프로젝트에 이어서 할예정!</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Kotlin-Querydsl-5장-JPA-Auditing-추가-분&quot;&gt;&lt;a href=&quot;#Kotlin-Querydsl-5장-JPA-Auditing-추가-분&quot; class=&quot;headerlink&quot; title=&quot;Kotlin, Querydsl 5장 
      
    
    </summary>
    
      <category term="Spring" scheme="http://yoursite.com/categories/Spring/"/>
    
      <category term="jpa" scheme="http://yoursite.com/categories/Spring/jpa/"/>
    
      <category term="audit" scheme="http://yoursite.com/categories/Spring/jpa/audit/"/>
    
      <category term="querydsl" scheme="http://yoursite.com/categories/Spring/jpa/audit/querydsl/"/>
    
      <category term="kotlin" scheme="http://yoursite.com/categories/Spring/jpa/audit/querydsl/kotlin/"/>
    
    
      <category term="Spring" scheme="http://yoursite.com/tags/Spring/"/>
    
      <category term="jpa" scheme="http://yoursite.com/tags/jpa/"/>
    
      <category term="audit" scheme="http://yoursite.com/tags/audit/"/>
    
      <category term="querydsl" scheme="http://yoursite.com/tags/querydsl/"/>
    
      <category term="kotlin" scheme="http://yoursite.com/tags/kotlin/"/>
    
  </entry>
  
  <entry>
    <title>Java File 모니터링</title>
    <link href="http://yoursite.com/2019/08/11/Java/file_observer/"/>
    <id>http://yoursite.com/2019/08/11/Java/file_observer/</id>
    <published>2019-08-11T07:30:00.000Z</published>
    <updated>2019-08-11T07:24:36.701Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Java-File-모니터링"><a href="#Java-File-모니터링" class="headerlink" title="Java File 모니터링"></a>Java File 모니터링</h1><p>Java File Walk활용하여 파일을 모니터링해보자</p><p><a href="https://github.com/beanbroker/spring_file_work" rel="external nofollow noopener noreferrer" target="_blank">git source</a> 소스 링크</p><p>왜 이러한 것이 추가되었을까에 대한 고찰?</p><blockquote><p>협력사 또는 회사 내부에서 특정 시간에 데이터(파일)들이 꾸준하게 ftp를 통해 파일이 생성되어진다고 가정을 하였을떄!</p></blockquote><ul><li>배치로 작동하는것이 옳을가? (만약 파일이 너무 무거워서 배치가 돌아야 할 시간에 정상적으로 업로드 되지 않은 경우)</li><li>누군가 같은 정해진 네이밍으로 한 파일을 올리고 잘못올림을 감지하고 다시 올렸을 경우(어찌 할것인가? 직접 서버로 들어가서 수정된시간을 볼것인가?)</li></ul><p>위와 같은 고민에서 시작한 선배 개발자의 의견에 키워드를 얻게되었고 해결방법에 대한 가이드를 전달받아 이 블로그를 작성합니다.</p><h2 id="1-키워드"><a href="#1-키워드" class="headerlink" title="1. 키워드"></a>1. 키워드</h2><p>WatchService ( 자바 1.7 도입 ) - 옵져버라 생각</p><p>StandardWatchEventKinds</p><ul><li>ENTRY_CREATE : 생성시</li><li>ENTRY_DELETE : 삭제시</li><li>ENTRY_MODIFY : 수정시</li></ul><h2 id="2-파일-생성-감지"><a href="#2-파일-생성-감지" class="headerlink" title="2. 파일 생성 감지"></a>2. 파일 생성 감지</h2><p>생성, 수정, 삭제에 대한 피드</p><blockquote><p>FileObserver.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">       String searchFileFolder = <span class="string">"search_file"</span>;</span><br><span class="line">       String targetDirectory = getWorkingDirectory() + <span class="string">"/"</span> + searchFileFolder;</span><br><span class="line">       observeFileCreated(targetDirectory);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">observeFileCreated</span><span class="params">(String targetDirectory)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">       Path faxFolder = Paths.get(targetDirectory);</span><br><span class="line"></span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">           WatchService fileWatchService = FileSystems.getDefault().newWatchService();</span><br><span class="line">           faxFolder.register(fileWatchService, StandardWatchEventKinds.ENTRY_CREATE);</span><br><span class="line"></span><br><span class="line">           <span class="keyword">boolean</span> valid = <span class="keyword">true</span>;</span><br><span class="line">           <span class="keyword">do</span> &#123;</span><br><span class="line">               WatchKey watchKey = fileWatchService.take();</span><br><span class="line"></span><br><span class="line">               <span class="keyword">for</span> (WatchEvent event : watchKey.pollEvents()) &#123;</span><br><span class="line">                   WatchEvent.Kind kind = event.kind();</span><br><span class="line">                   <span class="keyword">if</span> (StandardWatchEventKinds.ENTRY_CREATE.equals(event.kind())) &#123;</span><br><span class="line">                       String fileName = event.context().toString();</span><br><span class="line">                       System.out.println(<span class="string">"start to notify file Created :"</span> + fileName + <span class="string">" , time : "</span> + LocalDateTime.now());</span><br><span class="line">                   &#125;</span><br><span class="line">               &#125;</span><br><span class="line">               valid = watchKey.reset();</span><br><span class="line"></span><br><span class="line">           &#125; <span class="keyword">while</span> (valid);</span><br><span class="line">       &#125; <span class="keyword">catch</span> (IOException | InterruptedException e) &#123;</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></p></blockquote><p>run후 파일을 새로 생성해보자</p><blockquote><p>console.log<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">start to notify file Created :test1 복사본.txt , time : 2019-08-11T16:11:29.992</span><br><span class="line">start to notify file Created :test3 복사본.txt , time : 2019-08-11T16:11:29.992</span><br></pre></td></tr></table></figure></p></blockquote><ol start="3"><li>파일 생성, 삭제 수정에 대한 모든 부분을 커버할수 있도록 해보자</li></ol><blockquote><p>FileObserverUpgrade.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">      String searchFileFolder = <span class="string">"search_file"</span>;</span><br><span class="line">      String targetDirectory = getWorkingDirectory() + <span class="string">"/"</span> + searchFileFolder;</span><br><span class="line">      observeFileStatus(targetDirectory);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">observeFileStatus</span><span class="params">(String targetDirectory)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      Path faxFolder = Paths.get(targetDirectory);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">          <span class="comment">//워치 서비스에 이벤트들 등</span></span><br><span class="line">          WatchService fileWatchService = FileSystems.getDefault().newWatchService();</span><br><span class="line">          faxFolder.register(fileWatchService,</span><br><span class="line">                  StandardWatchEventKinds.ENTRY_CREATE,</span><br><span class="line">                  StandardWatchEventKinds.ENTRY_MODIFY,</span><br><span class="line">                  StandardWatchEventKinds.ENTRY_DELETE,</span><br><span class="line">                  StandardWatchEventKinds.OVERFLOW</span><br><span class="line"></span><br><span class="line">                  );</span><br><span class="line"></span><br><span class="line">          <span class="keyword">boolean</span> valid = <span class="keyword">true</span>;</span><br><span class="line">          <span class="keyword">do</span> &#123;</span><br><span class="line">              WatchKey watchKey = fileWatchService.take();</span><br><span class="line"></span><br><span class="line">              <span class="keyword">for</span> (WatchEvent event : watchKey.pollEvents()) &#123;</span><br><span class="line"></span><br><span class="line">                  <span class="keyword">if</span> (StandardWatchEventKinds.ENTRY_CREATE.equals(event.kind())) &#123;</span><br><span class="line">                      String fileName = event.context().toString();</span><br><span class="line">                      System.out.println(<span class="string">"start to notify file Created :"</span> + fileName + <span class="string">" , time : "</span> + LocalDateTime.now());</span><br><span class="line">                  &#125;<span class="keyword">else</span> <span class="keyword">if</span>(StandardWatchEventKinds.ENTRY_MODIFY.equals(event.kind()))&#123;</span><br><span class="line">                      String fileName = event.context().toString();</span><br><span class="line">                      System.out.println(<span class="string">"start to notify file modified :"</span> + fileName + <span class="string">" , time : "</span> + LocalDateTime.now());</span><br><span class="line">                  &#125;<span class="keyword">else</span> <span class="keyword">if</span>(StandardWatchEventKinds.ENTRY_DELETE.equals(event.kind()))&#123;</span><br><span class="line">                      String fileName = event.context().toString();</span><br><span class="line">                      System.out.println(<span class="string">"start to notify file deleted :"</span> + fileName + <span class="string">" , time : "</span> + LocalDateTime.now());</span><br><span class="line">                  &#125;<span class="keyword">else</span> <span class="keyword">if</span>(StandardWatchEventKinds.OVERFLOW.equals(event.kind())) &#123;</span><br><span class="line">                      String fileName = event.context().toString();</span><br><span class="line">                      System.out.println(<span class="string">"start to notify OVERFLOW  time : "</span> + LocalDateTime.now());</span><br><span class="line">                  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                      System.out.println(<span class="string">"UNKNOWN EVENT ......"</span>);</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;</span><br><span class="line">              valid = watchKey.reset();</span><br><span class="line"></span><br><span class="line">          &#125; <span class="keyword">while</span> (valid);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (IOException | InterruptedException e) &#123;</span><br><span class="line">          e.printStackTrace();</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p></blockquote><p>console.log<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">start to notify file Created :test1 복사본 2.txt , time : 2019-08-11T16:19:18.057</span><br><span class="line">start to notify file modified :.DS_Store , time : 2019-08-11T16:19:37.999</span><br><span class="line">start to notify file deleted :test1 복사본 2.txt , time : 2019-08-11T16:19:37.999</span><br><span class="line">start to notify file modified :test3 복사본.txt , time : 2019-08-11T16:19:57.999</span><br></pre></td></tr></table></figure></p><p>정상작동 체크!</p><p>물론 비정상적으로 작동하는 부분 체크나, 대용량 처리 등의 테스트는 반드시 필요함을 인지해야한다. 아마 이러한 부분을 다른 방법으로 쓸수 있는 여러가지 서비스들이 있을 것이다. 대표적으로 aws cloud watch같은 경우 버튼 몇번과 해당 디렉토리 설정해주는 config만 변경시 모든 로그를 땡겨서 쓸수 있다. cloud watch의 filter 로그 검색기능은 환상적이다.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Java-File-모니터링&quot;&gt;&lt;a href=&quot;#Java-File-모니터링&quot; class=&quot;headerlink&quot; title=&quot;Java File 모니터링&quot;&gt;&lt;/a&gt;Java File 모니터링&lt;/h1&gt;&lt;p&gt;Java File Walk활용하여 파일을
      
    
    </summary>
    
      <category term="Java" scheme="http://yoursite.com/categories/Java/"/>
    
      <category term="File Walk" scheme="http://yoursite.com/categories/Java/File-Walk/"/>
    
      <category term="WatchService" scheme="http://yoursite.com/categories/Java/File-Walk/WatchService/"/>
    
    
      <category term="Java" scheme="http://yoursite.com/tags/Java/"/>
    
      <category term="File Walk" scheme="http://yoursite.com/tags/File-Walk/"/>
    
      <category term="WatchService" scheme="http://yoursite.com/tags/WatchService/"/>
    
  </entry>
  
  <entry>
    <title>Java File Walk</title>
    <link href="http://yoursite.com/2019/08/11/Java/walk_file1/"/>
    <id>http://yoursite.com/2019/08/11/Java/walk_file1/</id>
    <published>2019-08-11T06:00:00.000Z</published>
    <updated>2019-08-11T06:17:30.986Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Java-File-Walk"><a href="#Java-File-Walk" class="headerlink" title="Java File Walk"></a>Java File Walk</h1><p>Java File Walk를 활용해보자</p><p><a href="https://github.com/beanbroker/spring_file_work" rel="external nofollow noopener noreferrer" target="_blank">git source</a> 소스 링크</p><h2 id="1-자신의-워킹디렉토리를-알아보자"><a href="#1-자신의-워킹디렉토리를-알아보자" class="headerlink" title="1. 자신의 워킹디렉토리를 알아보자"></a>1. 자신의 워킹디렉토리를 알아보자</h2><p>자신의 워킹디렉토리를 알아보는 방법</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getWorkingDirectory</span><span class="params">()</span></span>&#123;</span><br><span class="line">       </span><br><span class="line">       <span class="keyword">return</span> System.getProperty(<span class="string">"user.dir"</span>);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h2 id="2-타켓-하위-디렉토리-아래-모든-파일-가져오기"><a href="#2-타켓-하위-디렉토리-아래-모든-파일-가져오기" class="headerlink" title="2. 타켓 하위 디렉토리 아래 모든 파일 가져오기"></a>2. 타켓 하위 디렉토리 아래 모든 파일 가져오기</h2><p>목표로 하는 폴더 생성 후 해당 폴더안에 test1.txt, test2.txt, test3.txt 파일 생성 등등 목표 디렉토리 안에 파일 생성</p><ul><li>타켓 디렉토리 밑에있는 모든 파일 가져오기</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">       <span class="comment">//2. 해당 하위 디렉토리 아래 모든 파일 가져오기</span></span><br><span class="line">       String searchFileFolder = <span class="string">"search_file"</span>;</span><br><span class="line">       String targetDirectory = getWorkingDirectory()+<span class="string">"/"</span> + searchFileFolder;</span><br><span class="line">       List&lt;String&gt; allFiles = getAllFiles(targetDirectory);</span><br><span class="line"></span><br><span class="line">       allFiles.forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title">getAllFiles</span><span class="params">(String targetPath)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">try</span> (Stream&lt;Path&gt; walk = Files.walk(Paths.get(targetPath))) &#123;</span><br><span class="line"></span><br><span class="line">           <span class="keyword">return</span> walk.filter(Files::isRegularFile)</span><br><span class="line">                   .map(Path::toString).collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">       &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><blockquote><p>console log<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/Users/beanbroker/pkj_private_work/spring_file_work/search_file/.DS_Store</span><br><span class="line">/Users/beanbroker/pkj_private_work/spring_file_work/search_file/test1.txt</span><br><span class="line">/Users/beanbroker/pkj_private_work/spring_file_work/search_file/test2.txt</span><br><span class="line">/Users/beanbroker/pkj_private_work/spring_file_work/search_file/test3.txt</span><br><span class="line">/Users/beanbroker/pkj_private_work/spring_file_work/search_file/testFolder3/test1 복사본.txt</span><br></pre></td></tr></table></figure></p></blockquote><p>위와같이 목표하는 폴더 밑의 모든 파일들을 들고온다.</p><h2 id="3-타켓-하위-디렉토리-아래-모든-폴더-가져오기"><a href="#3-타켓-하위-디렉토리-아래-모든-폴더-가져오기" class="headerlink" title="3. 타켓 하위 디렉토리 아래 모든 폴더 가져오기"></a>3. 타켓 하위 디렉토리 아래 모든 폴더 가져오기</h2><p>동일하게 타멧 디렉토리 안에 원하는 만큼 폴더를 생성하자</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    String searchFileFolder = <span class="string">"search_file"</span>;</span><br><span class="line">    String targetDirectory = getWorkingDirectory() + <span class="string">"/"</span> + searchFileFolder;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3. 해당 하위 디렉토리 아래 모든 폴더 가져오기</span></span><br><span class="line">    List&lt;String&gt; allFolders = getAllFolders(targetDirectory);</span><br><span class="line">    allFolders.forEach(System.out::println);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title">getAllFolders</span><span class="params">(String targetPath)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> (Stream&lt;Path&gt; walk = Files.walk(Paths.get(targetPath))) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> walk.filter(Files::isDirectory)</span><br><span class="line">                .map(Path::toString).collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>console log<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/Users/beanbroker/pkj_private_work/spring_file_work/search_file</span><br><span class="line">/Users/beanbroker/pkj_private_work/spring_file_work/search_file/testFolder1</span><br><span class="line">/Users/beanbroker/pkj_private_work/spring_file_work/search_file/testFolder2</span><br><span class="line">/Users/beanbroker/pkj_private_work/spring_file_work/search_file/testFolder3</span><br></pre></td></tr></table></figure></p></blockquote><p>결과는 위와 같이 정상적으로 잘노출된다.</p><h2 id="4-해당-하위-디렉토리-아래-목표로하는-확장자-파일들가져오기"><a href="#4-해당-하위-디렉토리-아래-목표로하는-확장자-파일들가져오기" class="headerlink" title="4. 해당 하위 디렉토리 아래 목표로하는 확장자 파일들가져오기"></a>4. 해당 하위 디렉토리 아래 목표로하는 확장자 파일들가져오기</h2><p>동일하게 타멧 디렉토리 안에 원하는 만큼 폴더를 생성하자</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    String searchFileFolder = <span class="string">"search_file"</span>;</span><br><span class="line">    String targetDirectory = getWorkingDirectory() + <span class="string">"/"</span> + searchFileFolder;</span><br><span class="line"></span><br><span class="line">     <span class="comment">//4. 해당 하위 디렉토리 아래 목표로하는 확장자 파일들가져오기</span></span><br><span class="line">    String targetFileExtension = <span class="string">"txt"</span>;</span><br><span class="line">    List&lt;String&gt; allFilesUnderFolders = getAllFilesWithFileExtension(targetDirectory, targetFileExtension);</span><br><span class="line">    allFilesUnderFolders.forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title">getAllFilesWithFileExtension</span><span class="params">(String targetPath, String extension)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> (Stream&lt;Path&gt; walk = Files.walk(Paths.get(targetPath))) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> walk.map(Path::toString)</span><br><span class="line">                .filter(f -&gt; f.endsWith(extension)).collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>console log<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/Users/beanbroker/pkj_private_work/spring_file_work/search_file/test1.txt</span><br><span class="line">/Users/beanbroker/pkj_private_work/spring_file_work/search_file/test2.txt</span><br><span class="line">/Users/beanbroker/pkj_private_work/spring_file_work/search_file/test3.txt</span><br><span class="line">/Users/beanbroker/pkj_private_work/spring_file_work/search_file/testFolder3/test1 복사본.txt</span><br></pre></td></tr></table></figure></p></blockquote><p>결과는 위와 같이 목표로 하는 확장자 파일들이 정상적으로 잘노출된다.</p><h2 id="5-해당-하위데릭토리에서-원하는-파일-찾기"><a href="#5-해당-하위데릭토리에서-원하는-파일-찾기" class="headerlink" title="5. 해당 하위데릭토리에서 원하는 파일 찾기"></a>5. 해당 하위데릭토리에서 원하는 파일 찾기</h2><p>동일하게 타멧 디렉토리 안에 원하는 만큼 폴더를 생성하자</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    String searchFileFolder = <span class="string">"search_file"</span>;</span><br><span class="line">    String targetDirectory = getWorkingDirectory() + <span class="string">"/"</span> + searchFileFolder;</span><br><span class="line"></span><br><span class="line">      <span class="comment">//5. 해당 하위데릭토리에서 원하는 파일 찾기</span></span><br><span class="line">    String targetFileName = <span class="string">"test1.txt"</span>;</span><br><span class="line">    List&lt;String&gt; tatgetFile = findFileUnderTargetFolder(targetDirectory, targetFileName);</span><br><span class="line">    tatgetFile.forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title">findFileUnderTargetFolder</span><span class="params">(String targetPath, String fileName)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> (Stream&lt;Path&gt; walk = Files.walk(Paths.get(targetPath))) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> walk.map(Path::toString)</span><br><span class="line">                .filter(f -&gt; f.contains(fileName))</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>console log<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/Users/beanbroker/pkj_private_work/spring_file_work/search_file/test1.txt</span><br></pre></td></tr></table></figure></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Java-File-Walk&quot;&gt;&lt;a href=&quot;#Java-File-Walk&quot; class=&quot;headerlink&quot; title=&quot;Java File Walk&quot;&gt;&lt;/a&gt;Java File Walk&lt;/h1&gt;&lt;p&gt;Java File Walk를 활용해보자&lt;
      
    
    </summary>
    
      <category term="Java" scheme="http://yoursite.com/categories/Java/"/>
    
      <category term="File Walk" scheme="http://yoursite.com/categories/Java/File-Walk/"/>
    
    
      <category term="Java" scheme="http://yoursite.com/tags/Java/"/>
    
      <category term="File Walk" scheme="http://yoursite.com/tags/File-Walk/"/>
    
  </entry>
  
  <entry>
    <title>Spring Jpa Rollback이 안될 떄</title>
    <link href="http://yoursite.com/2019/08/04/Spring/spring_jpa_rollback_tip/"/>
    <id>http://yoursite.com/2019/08/04/Spring/spring_jpa_rollback_tip/</id>
    <published>2019-08-04T07:50:00.000Z</published>
    <updated>2019-08-04T09:51:31.208Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Spring-Jpa-RollbackTest가-정상적으로-되지-않을-때"><a href="#Spring-Jpa-RollbackTest가-정상적으로-되지-않을-때" class="headerlink" title="Spring Jpa RollbackTest가 정상적으로 되지 않을 때"></a>Spring Jpa RollbackTest가 정상적으로 되지 않을 때</h1><h2 id="고생하엿던-부분"><a href="#고생하엿던-부분" class="headerlink" title="고생하엿던 부분."></a>고생하엿던 부분.</h2><p>스프링 jpa테스트를 진행하려고 하던 도중 만약에 안될시<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Issue is with MySQL Database engine. My engine was MYIsam which doesn&apos;t supports Transactions. I changed my DB engine to InnoDB and its working. Thanks for the contributions. Below are the queries for the same.</span><br><span class="line"></span><br><span class="line">SELECT ENGINE FROM information_schema.TABLES WHERE TABLE_NAME = &apos;tabel_name&apos; AND TABLE_SCHEMA=&apos;db_name&apos;;</span><br><span class="line"></span><br><span class="line">ALTER TABLE table_name ENGINE = INNODB;</span><br></pre></td></tr></table></figure></p><p>위의 부분을 확인해보자… (<a href="https://stackoverflow.com/questions/54293032/spring-boot-jpa-transactional-annotation-roll-back-is-not-working" rel="external nofollow noopener noreferrer" target="_blank">https://stackoverflow.com/questions/54293032/spring-boot-jpa-transactional-annotation-roll-back-is-not-working</a>)</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Spring-Jpa-RollbackTest가-정상적으로-되지-않을-때&quot;&gt;&lt;a href=&quot;#Spring-Jpa-RollbackTest가-정상적으로-되지-않을-때&quot; class=&quot;headerlink&quot; title=&quot;Spring Jpa Rollb
      
    
    </summary>
    
      <category term="Spring" scheme="http://yoursite.com/categories/Spring/"/>
    
      <category term="jpa" scheme="http://yoursite.com/categories/Spring/jpa/"/>
    
      <category term="rollback" scheme="http://yoursite.com/categories/Spring/jpa/rollback/"/>
    
    
      <category term="Spring" scheme="http://yoursite.com/tags/Spring/"/>
    
      <category term="jpa" scheme="http://yoursite.com/tags/jpa/"/>
    
      <category term="rollback" scheme="http://yoursite.com/tags/rollback/"/>
    
  </entry>
  
  <entry>
    <title>Spring RestTemplate 실무 적용 추상화</title>
    <link href="http://yoursite.com/2019/07/28/Spring/restTemplate/"/>
    <id>http://yoursite.com/2019/07/28/Spring/restTemplate/</id>
    <published>2019-07-28T07:50:00.000Z</published>
    <updated>2019-07-28T07:36:22.452Z</updated>
    
    <content type="html"><![CDATA[<h1 id="RestTemplate-실무에-제대로-적용해보자"><a href="#RestTemplate-실무에-제대로-적용해보자" class="headerlink" title="RestTemplate 실무에 제대로 적용해보자"></a>RestTemplate 실무에 제대로 적용해보자</h1><p><a href="https://github.com/beanbroker/querydsl_java_spring" rel="external nofollow noopener noreferrer" target="_blank">git source</a> 링크</p><p>RestTemplate을 실무에 적용할수 있도록 추상화 해보자</p><p>특징</p><ol><li>동기 클라이언트</li><li>스프링5.0이 올라가면서 WebClient가 대세가 된! 그래도 좋은 client</li><li>fegin의 내부 구현체</li></ol><h2 id="CRUD"><a href="#CRUD" class="headerlink" title="CRUD"></a>CRUD</h2><p>Create : Post Method<br>Read : Get Method<br>Update : Put Method<br>Delete : Delete Method</p><p>Post,Put : requestBody<br>Get, Delete : RequestBody 사용하지 않음</p><ul><li>공식 가이드에서는 그러함</li><li>Webclient 사용시 delete 에서 body에 데이터 넣을 수 없음 그럼 우찌함?</li><li>메서드 .delete()로 쓰지 말고 .method()해서 메소드 선택하면 쓸수 있음</li><li>이번 장의 강의는 webclient가 아닌 restTemplate</li></ul><h2 id="추상화-해보자"><a href="#추상화-해보자" class="headerlink" title="추상화 해보자"></a>추상화 해보자</h2><blockquote><p>SampleRestClient.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">SampleRestClient</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> String endPointHost;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RestTemplate client;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> &lt;T&gt; <span class="function">RequestEntity&lt;T&gt; <span class="title">beforeSend</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">            String subUri, HttpMethod method, T bodyData</span></span></span><br><span class="line"><span class="function"><span class="params">    )</span> <span class="keyword">throws</span> URISyntaxException </span>&#123;</span><br><span class="line"></span><br><span class="line">        RequestEntity&lt;T&gt; request = RequestEntity.method(method, <span class="keyword">new</span> URI(endPointHost + subUri))</span><br><span class="line">                .contentType(MediaType.APPLICATION_JSON)</span><br><span class="line">                .accept(MediaType.APPLICATION_JSON)</span><br><span class="line">                .body(bodyData);</span><br><span class="line"></span><br><span class="line">        client.setErrorHandler(<span class="keyword">new</span> ClientErrorHandler());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> request;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> &lt;T, S&gt; <span class="function">ResponseEntity&lt;S&gt; <span class="title">send</span><span class="params">(String subUri, HttpMethod method, T bodyData, Class&lt;S&gt; returnClassName)</span> <span class="keyword">throws</span> URISyntaxException </span>&#123;</span><br><span class="line"></span><br><span class="line">        ResponseEntity&lt;S&gt; response = client.exchange(beforeSend(subUri, method, bodyData), returnClassName);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> response;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> &lt;T, S&gt; <span class="function">ResponseEntity&lt;S&gt; <span class="title">send</span><span class="params">(String subUri, HttpMethod method, T bodyData, ParameterizedTypeReference&lt;S&gt; returnClassName)</span> <span class="keyword">throws</span> URISyntaxException </span>&#123;</span><br><span class="line"></span><br><span class="line">        ResponseEntity&lt;S&gt; response = client.exchange(beforeSend(subUri, method, bodyData), returnClassName);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> response;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> RequestEntity&lt;Void&gt; <span class="title">beforeSendGetMethod</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">            String subUri, HttpMethod method</span></span></span><br><span class="line"><span class="function"><span class="params">    )</span> <span class="keyword">throws</span> URISyntaxException </span>&#123;</span><br><span class="line"></span><br><span class="line">        RequestEntity.BodyBuilder builder = RequestEntity.method(method, <span class="keyword">new</span> URI(endPointHost + subUri))</span><br><span class="line">                .accept(MediaType.APPLICATION_JSON);</span><br><span class="line"></span><br><span class="line">        client.setErrorHandler(<span class="keyword">new</span> ClientErrorHandler());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> builder.build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> &lt;S&gt; <span class="function">ResponseEntity&lt;S&gt; <span class="title">send</span><span class="params">(String subUri, HttpMethod method, Class&lt;S&gt; returnClassName)</span> <span class="keyword">throws</span> URISyntaxException </span>&#123;</span><br><span class="line"></span><br><span class="line">        ResponseEntity&lt;S&gt; response = client.exchange(beforeSendGetMethod(subUri, method), returnClassName);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> response;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> &lt;S&gt; <span class="function">ResponseEntity&lt;S&gt; <span class="title">send</span><span class="params">(String subUri, HttpMethod method, ParameterizedTypeReference&lt;S&gt; returnClassName)</span> <span class="keyword">throws</span> URISyntaxException </span>&#123;</span><br><span class="line"></span><br><span class="line">        ResponseEntity&lt;S&gt; response = client.exchange(beforeSendGetMethod(subUri, method), returnClassName);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> response;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></blockquote><ol><li>명시적으로 return클래스 보여주자</li><li>ClientErrorHandler를 달아서 클라이언트 통신에서 발생하는 에러는 명시적으로 확인하자</li></ol><blockquote><p>ClientErrorHandler.java</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClientErrorHandler</span> <span class="keyword">implements</span> <span class="title">ResponseErrorHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasError</span><span class="params">(ClientHttpResponse response)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> response.getStatusCode().series()!= HttpStatus.Series.SUCCESSFUL;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleError</span><span class="params">(ClientHttpResponse response)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        String resString = StreamUtils.copyToString(response.getBody(), Charsets.UTF_8);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        log.debug(<span class="string">"start to check what is wrong "</span>);</span><br><span class="line">        log.debug(<span class="string">"Status code  : &#123;&#125;"</span>, response.getStatusCode());</span><br><span class="line">        log.debug(<span class="string">"Status text  : &#123;&#125;"</span>, response.getStatusText());</span><br><span class="line">        log.debug(<span class="string">"Headers      : &#123;&#125;"</span>, response.getHeaders());</span><br><span class="line">        log.debug(<span class="string">"Response body: &#123;&#125;"</span>, resString);</span><br><span class="line">        log.debug(<span class="string">"end to check what is wrong"</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//이쪽부분에서 정의한 exception으로 던진 후 adviceController에서 정의된 에러를 던져함</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>HttpStatus가 200이 아닐 경우 던져서 명시적으로 에러를 확인하자(귀찮아서 못달겟음;…..)</li></ol><h2 id="실제-구현체"><a href="#실제-구현체" class="headerlink" title="실제 구현체"></a>실제 구현체</h2><blockquote><p>UserClient.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserClient</span> <span class="keyword">extends</span> <span class="title">SampleRestClient</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String host = <span class="string">"http://localhost:9090"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String uri = <span class="string">"/user"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UserClient</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.endPointHost = host;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createUser</span><span class="params">(UserInfo userInfo)</span> <span class="keyword">throws</span> URISyntaxException </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        send(uri, HttpMethod.POST, userInfo, (Class&lt;Object&gt;) <span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateUser</span><span class="params">(UserInfo userInfo)</span> <span class="keyword">throws</span> URISyntaxException </span>&#123;</span><br><span class="line"></span><br><span class="line">        send(uri, HttpMethod.PUT, userInfo, (Class&lt;Object&gt;) <span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResponseEntity&lt;UserInfo&gt; <span class="title">getUser</span><span class="params">(String userId)</span> <span class="keyword">throws</span> URISyntaxException </span>&#123;</span><br><span class="line"></span><br><span class="line">        String temp = uri+ <span class="string">"?userId="</span> + userId;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> send(temp, HttpMethod.GET , UserInfo.class);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">removeUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></blockquote><ol><li>맨뒤에 파라미터는 null이 들어갈수 있게 하는 이유는 명시적으로 status code만 체크 할뿐! 바디값은 없다 이런뜻으로..</li></ol><p>샘플코드를 짤때 프로젝트를 분리해서 짜야 했으나.. 그렇게 하지 않아.. 불편함 점이 있음. 위의 글들을 다른 프로젝트에서 짜는 것을 추천</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;RestTemplate-실무에-제대로-적용해보자&quot;&gt;&lt;a href=&quot;#RestTemplate-실무에-제대로-적용해보자&quot; class=&quot;headerlink&quot; title=&quot;RestTemplate 실무에 제대로 적용해보자&quot;&gt;&lt;/a&gt;RestTemp
      
    
    </summary>
    
      <category term="Spring" scheme="http://yoursite.com/categories/Spring/"/>
    
      <category term="Junit" scheme="http://yoursite.com/categories/Spring/Junit/"/>
    
    
      <category term="Spring" scheme="http://yoursite.com/tags/Spring/"/>
    
      <category term="Junit" scheme="http://yoursite.com/tags/Junit/"/>
    
  </entry>
  
  <entry>
    <title>Spring test code (일단 해보자)</title>
    <link href="http://yoursite.com/2019/07/27/Spring/test_code_0727/"/>
    <id>http://yoursite.com/2019/07/27/Spring/test_code_0727/</id>
    <published>2019-07-27T13:50:00.000Z</published>
    <updated>2019-07-28T05:31:02.519Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Junit-테스트"><a href="#Junit-테스트" class="headerlink" title="Junit 테스트"></a>Junit 테스트</h1><p><a href="https://beanbroker.github.io/2018/07/28/Spring/test_code1/" rel="external nofollow noopener noreferrer" target="_blank">test_code 1장</a> 링크</p><p><a href="https://beanbroker.github.io/2018/08/04/Spring/test_code2/" rel="external nofollow noopener noreferrer" target="_blank">test_code 2장</a> 링크</p><p><a href="https://beanbroker.github.io/2018/08/04/Spring/test_code3/" rel="external nofollow noopener noreferrer" target="_blank">test_code 3장</a> 링크</p><p>위의 글을 작성할것을.. 블로그에 올리기전에 발견.. 하 노답…. </p><p>지금 작성하고 있는 글은 100프로 정확하지 않으며 따라하지 않기를 권하며…. 혼자 공부한 글임을….</p><p><a href="https://github.com/beanbroker/querydsl_java_spring" rel="external nofollow noopener noreferrer" target="_blank">git source</a> 링크</p><h2 id="테스트-코드의-필요성"><a href="#테스트-코드의-필요성" class="headerlink" title="테스트 코드의 필요성"></a>테스트 코드의 필요성</h2><p>테스트 코드가 중요한것은 모든 개발자들이 동감을 할것이다. 하지만… 시간이 없어서 테스트 코드때문에 자신이 짠 비지니스 로직을 바꿔야하는 경우도 있고, 환경에 따라 값이 변하는 경우도 있다, 테스트코드에서 environment를 local 또는 dev로 설정 후 하더라도 실제 테스트 하려는 코드에서 env를 직접 주입하여 해당 환경에서 인스턴스가 올라갈경우 테스트코드의 env와 테스트 대상인 env의 설정 값이 달라 틀려질 경우도 있다. 너무나 어려운것….하….</p><p>테스트 코드를 짜게되면 비지니스 로직이 변경되거나 사이드이펙트 체크가 쉽다. 해당 부분은 다른 블로그에서 찾아서 보는 것이 빠르다.</p><h2 id="SpringBootTest를-쓰기전에"><a href="#SpringBootTest를-쓰기전에" class="headerlink" title="SpringBootTest를 쓰기전에!"></a>SpringBootTest를 쓰기전에!</h2><p><strong>@SpringBootTest</strong> 를 사용하게 되면 ApplicationContext를 쉽게 생성 및 조작이 가능하다.</p><p>@RunWith(SpringRunner.class)와 스프링테스트는 같이쓰여져야 한다.</p><h2 id="실습을-해보자"><a href="#실습을-해보자" class="headerlink" title="실습을 해보자"></a>실습을 해보자</h2><p><a href="https://beanbroker.github.io/2019/07/13/Java/java_querydsl_gradle4-1/" rel="external nofollow noopener noreferrer" target="_blank">querydsl 관련 내용 블로그</a></p><p>위의 블로그에서 작성한 코드를 기반으로 테스트 코드를 작성해보자</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@NoArgsConstructor</span>(access = AccessLevel.PROTECTED)</span><br><span class="line"><span class="meta">@Entity</span>(name = <span class="string">"users"</span>)</span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserEntity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column</span></span><br><span class="line">    <span class="keyword">private</span> String userId;</span><br><span class="line">    <span class="meta">@Column</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="meta">@Column</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Builder</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UserEntity</span><span class="params">(String userId, String name, <span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.userId = userId;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>옛날 소스와 많이 다르지 않지만 덕지덕지 붙어있었던 불필요한 부분 삭제를 하였다.</p><blockquote><p>테스트 할 내용은 유저를 생성하고 조회한다 가정해보자</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Transactional</span>(readOnly = <span class="keyword">false</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createUser</span><span class="params">(String userId, String userName, <span class="keyword">int</span> age)</span></span>&#123;</span><br><span class="line">    </span><br><span class="line">    userRepository.save(</span><br><span class="line">            UserEntity.builder().userId(userId).name(userName).age(age).build()</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Transactional</span>(readOnly = <span class="keyword">true</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> UserEntity <span class="title">getUserId</span><span class="params">(String userId)</span> <span class="keyword">throws</span> NotFoundException </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    userRepository.getByUserId(userId);</span><br><span class="line">    Optional&lt;UserEntity&gt; userEntity = Optional.ofNullable(userRepository.getByUserId(userId));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!userEntity.isPresent())&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NotFoundException(<span class="string">"Not Found"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    UserInfo userInfo = <span class="keyword">new</span> UserInfo();</span><br><span class="line">    userInfo.setUserAge(userEntity.get().getAge());</span><br><span class="line">    userInfo.setUserName(userEntity.get().getName());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> userEntity.get();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>생성과 삭제코드 </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@RunWith</span>(SpringRunner.class)</span><br><span class="line"><span class="meta">@SpringBootTest</span>(classes = UserService.class)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@MockBean</span></span><br><span class="line">    UserRepository userRepository;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String TEST_USER_ID = <span class="string">"powertest"</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String TEST_USER_NAME = <span class="string">"룰루랄라"</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> TEST_USER_AGE = <span class="number">13</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">cleanup</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        userService.deleteUser(TEST_USER_ID);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AfterSaveUser_GetUserInfo</span><span class="params">()</span> <span class="keyword">throws</span> NotFoundException </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//Given 유저를 생성하였고</span></span><br><span class="line">        userService.createUser(TEST_USER_ID, TEST_USER_NAME, TEST_USER_AGE);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//When 유져를 찾을때</span></span><br><span class="line">        UserEntity userEntity = userService.getUserId(TEST_USER_ID);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//then 유저의 이름은 룰루랄라이다</span></span><br><span class="line">        assertThat(userEntity.getName(), is(TEST_USER_NAME));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span>(expected = NotFoundException.class)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">checkExpectedException</span><span class="params">()</span> <span class="keyword">throws</span> NotFoundException </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//When 유져를 찾을때</span></span><br><span class="line">        UserEntity userEntity = userService.getUserId(<span class="string">"sadfsd"</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>물론 위처럼 작성하면 너무나 당연하게 통과한다… 위처럼 작성 후  다음에 다시 테스트를 돌릴경우 userId가 Unique값이라면 정상저긍로 작동하지 않을 것이다. 그렇기 때문에 After 생성한 삭제를 삭제해주자</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Junit-테스트&quot;&gt;&lt;a href=&quot;#Junit-테스트&quot; class=&quot;headerlink&quot; title=&quot;Junit 테스트&quot;&gt;&lt;/a&gt;Junit 테스트&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://beanbroker.github.io/2018
      
    
    </summary>
    
      <category term="Spring" scheme="http://yoursite.com/categories/Spring/"/>
    
      <category term="Junit" scheme="http://yoursite.com/categories/Spring/Junit/"/>
    
    
      <category term="Spring" scheme="http://yoursite.com/tags/Spring/"/>
    
      <category term="Junit" scheme="http://yoursite.com/tags/Junit/"/>
    
  </entry>
  
  <entry>
    <title>Spring cloud 1장 (gateway)</title>
    <link href="http://yoursite.com/2019/07/21/spring_cloud/spring_cloud_gateway1/"/>
    <id>http://yoursite.com/2019/07/21/spring_cloud/spring_cloud_gateway1/</id>
    <published>2019-07-21T09:30:00.000Z</published>
    <updated>2019-07-21T09:29:29.652Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Spring-cloud-1장-gateway"><a href="#Spring-cloud-1장-gateway" class="headerlink" title="Spring cloud 1장 (gateway)"></a>Spring cloud 1장 (gateway)</h1><p>심심해서 해보는 스프링 클라우드 샘플코드 만들어보기</p><p><a href="https://github.com/beanbroker/sample_spring_cloud_gw" rel="external nofollow noopener noreferrer" target="_blank">github 소스</a> 링크</p><h1 id="Spring-cloud란"><a href="#Spring-cloud란" class="headerlink" title="Spring cloud란"></a>Spring cloud란</h1><p><a href="https://spring.io/projects/spring-cloud-gateway" rel="external nofollow noopener noreferrer" target="_blank">Spring 공홈 </a> 링크</p><p>이것을 설명하기보다는… 유명한 네이버, 우아한형제 등등 기술블로그에서 검색하여 간단하게 읽는 것을 강력하게 추천! 설명 잘되어있음</p><h2 id="A-시작해보자"><a href="#A-시작해보자" class="headerlink" title="A. 시작해보자"></a>A. 시작해보자</h2><blockquote><p>build.gradle</p></blockquote><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">dependencies</span> &#123;</span><br><span class="line">    implementation <span class="string">'org.springframework.cloud:spring-cloud-starter'</span></span><br><span class="line">    implementation <span class="string">'org.springframework.cloud:spring-cloud-starter-gateway'</span></span><br><span class="line">    implementation <span class="string">'org.springframework.cloud:spring-cloud-starter-sleuth'</span></span><br><span class="line">    implementation <span class="string">'org.springframework.cloud:spring-cloud-starter-zipkin'</span></span><br><span class="line">    testImplementation <span class="string">'org.springframework.boot:spring-boot-starter-test'</span></span><br><span class="line"></span><br><span class="line">    compileOnly <span class="string">'org.projectlombok:lombok'</span></span><br><span class="line">    implementation <span class="string">'org.springframework.boot:spring-boot-starter-data-redis'</span></span><br><span class="line">    <span class="keyword">compile</span> <span class="keyword">group</span>: <span class="string">'it.ozimov'</span>, name: <span class="string">'embedded-redis'</span>, version: <span class="string">'0.7.2'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>다른것을 해보기 위해 미리 디펜던시들을 추가하였고 이번장에서 중요허게 봐야할 부분은 gateway, sleuth이다. 물론 zuul도 나중에.. 시간이 된다면 추가해서 무엇이 다른지에 대한 설명을 추가해야된다.</p><h3 id="게이트웨이란"><a href="#게이트웨이란" class="headerlink" title="게이트웨이란?"></a>게이트웨이란?</h3><ul><li>end point를 통합하는 서버이다( 클라이언트 요청의 집합소!). like 프록시 서버</li></ul><h3 id="슬루스란"><a href="#슬루스란" class="headerlink" title="슬루스란?"></a>슬루스란?</h3><ul><li>SOA, MSA이건 여러개의 서비스에서 서로간의 통신을 한다고 가정을 하자!<ul><li>로그 추적을 어떻게??</li><li>이를 쉽게 해주는 서비스 Sleuth</li><li>Sleuth traceId와 spanId제공</li></ul></li></ul><h3 id="Span-ID"><a href="#Span-ID" class="headerlink" title="Span ID"></a>Span ID</h3><ul><li>작업의 기본 단위이다. 각 서비스 호출시에 새로운 Span이 하나 생성  </li><li>Description, key-value annotation, process ID 등의 추가 정보를 가짐</li><li>Trace에서 제일 처음 만들어지는 Span을 root span이라 함(trace id와 동일)</li></ul><h3 id="Trace-ID"><a href="#Trace-ID" class="headerlink" title="Trace ID"></a>Trace ID</h3><ul><li>최초 호출시 인입 서비스에서 생성 </li></ul><h2 id="B-소스를-적용해보자"><a href="#B-소스를-적용해보자" class="headerlink" title="B. 소스를 적용해보자"></a>B. 소스를 적용해보자</h2><blockquote><p>RouterConfig.class</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableWebFlux</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RouterConfig</span> <span class="keyword">implements</span> <span class="title">WebFluxConfigurer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RouterFunction&lt;ServerResponse&gt; <span class="title">routes</span><span class="params">(HelloWorldHandler handler)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> route(GET(<span class="string">"/"</span>), handler::helloWorld);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>HelloWorldHandler.class</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorldHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger logger = LoggerFactory.getLogger(HelloWorldHandler.class);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Mono&lt;ServerResponse&gt; <span class="title">helloWorld</span><span class="params">(ServerRequest request)</span> </span>&#123;</span><br><span class="line">        logger.info(<span class="string">"start to get healthcheck"</span>);</span><br><span class="line">        <span class="keyword">return</span> ServerResponse.ok().body(Mono.just(<span class="string">"hello"</span>), String.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>위처럼 하면 끝이다. 물론 현재 프록시하는 역할을 가지고 있지 않다. 2장에서 서비스 서버 하나를 띄우고 어찌작동되는지 함께 보여줄 예정</p><p>위처럼 하고 실행! 후 <a href="http://localhost:9000/" rel="external nofollow noopener noreferrer" target="_blank">http://localhost:9000/</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2019-07-21 18:19:10.084  INFO [gateway,3fb0ee4984a21a7e,3fb0ee4984a21a7e,false] 37457 --- [ctor-http-nio-2] c.b.beangw.handler.HelloWorldHandler     : start to get healthcheck</span><br></pre></td></tr></table></figure><p>앞쪽이 traceId, 뒤쪽이 spanid이다</p><blockquote><p>집킨설정을 통해 로그를 바꿔보자</p></blockquote><blockquote><p>application.yml<br><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  zipkin:</span></span><br><span class="line"><span class="attr">    service:</span></span><br><span class="line"><span class="attr">      name:</span> <span class="string">sample-gw</span></span><br></pre></td></tr></table></figure></p></blockquote><p>재기동 후 로그는 아래처럼</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2019-07-21 18:22:25.117  INFO [sample-gw,1c296c8c12cc57b5,1c296c8c12cc57b5,false] 37462 --- [ctor-http-nio-2] c.b.beangw.handler.HelloWorldHandler     : start to get healthcheck</span><br></pre></td></tr></table></figure><h2 id="C-헤더에-traceID를-심어보자"><a href="#C-헤더에-traceID를-심어보자" class="headerlink" title="C. 헤더에 traceID를 심어보자"></a>C. 헤더에 traceID를 심어보자</h2><blockquote><p>GatewayDefaultConfig.class</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GatewayDefaultConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Tracer tracer;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GatewayDefaultConfig</span><span class="params">(Tracer tracer)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.tracer = tracer;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger logger = LoggerFactory.getLogger(GatewayDefaultConfig.class);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> GlobalFilter <span class="title">lifeLandGlobalFilter</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> (exchange, chain) -&gt; chain.filter(exchange).then(Mono.fromRunnable(() -&gt; &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            String tracerId = tracer.currentSpan().context().traceIdString();</span><br><span class="line"></span><br><span class="line">                exchange.getResponse().getHeaders().set(<span class="string">"X-BEANBROKER-TRACE"</span>, tracerId);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>음 실제로 운영하다보면 헤더에 trace-id를 넣어서 하면 좋은 경우가 있다.</p><p>2장에서 실제로 서비스서버로 호출하여 trace-id가 찍히는지 확인해보자!</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Spring-cloud-1장-gateway&quot;&gt;&lt;a href=&quot;#Spring-cloud-1장-gateway&quot; class=&quot;headerlink&quot; title=&quot;Spring cloud 1장 (gateway)&quot;&gt;&lt;/a&gt;Spring cloud 1장
      
    
    </summary>
    
      <category term="spring_cloud" scheme="http://yoursite.com/categories/spring-cloud/"/>
    
      <category term="gateway" scheme="http://yoursite.com/categories/spring-cloud/gateway/"/>
    
    
      <category term="spring_cloud" scheme="http://yoursite.com/tags/spring-cloud/"/>
    
      <category term="gateway" scheme="http://yoursite.com/tags/gateway/"/>
    
  </entry>
  
</feed>
